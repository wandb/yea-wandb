[tox]
minversion = 3.23.1
envlist = black,flake8,mypy,py37

[testenv]
deps =
    pytest
commands =
    python -m pytest {posargs:tests/}

[testenv:flake8]
basepython = python3
skip_install = true
deps =
    flake8
    flake8-colors
    flake8-bugbear
    pep8-naming
    flake8-fixme
    flake8-typing-imports
    flake8-import-order
commands =
    flake8 {posargs:src/}

[testenv:mypy]
basepython = python3
skip_install = true
deps =
    mypy==0.812
    lxml
setenv =
    MYPYPATH = {toxinidir}
commands =
    mypy --show-error-codes --html-report mypy-results/ src/

[flake8]
max-line-length = 120
exclude =
    src/yea_wandb/mock_server.py
    src/yea_wandb/mock_requests.py
ignore =
    # TODO()'s are allowed for now
    T101,

[black]
paths = src/ setup.py
deps = black

[testenv:blackformat]
deps = {[black]deps}
basepython = python3
skip_install = true
commands =
    black {[black]paths}

[testenv:black]
deps = {[black]deps}
basepython = python3
skip_install = true
commands =
    black --check {[black]paths}

[testenv:blackdiff]
basepython = python3
skip_install = true
deps = {[black]deps}
commands =
    black --diff {[black]paths}

[isort]
profile = black
skip =
    src/yea_wandb/mock_server.py
    src/yea_wandb/mock_requests.py

[isortbase]
args = -o yea -p yaml

[testenv:isort]
deps = isort
basepython = python3
skip_install = true
commands =
    isort {[isortbase]args} --check {posargs:src/}

[testenv:isortformat]
deps = isort
basepython = python3
skip_install = true
commands =
    isort {[isortbase]args} {posargs:src/}

[testenv:isortdiff]
deps = isort
basepython = python3
skip_install = true
commands =
    isort {[isortbase]args} --check --diff {posargs:src/}
